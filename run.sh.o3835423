Variable OMP_NUM_THREADS has been set to 16
--------------------
Hostname: sbg9
Sun Sep  8 09:18:07 BST 2024
Free GPU: 0 of 2
--------------------
GPU0: [92mNot in use.[39m
GPU1: [92mNot in use.[39m

User: [91macw572[39m JobID: [91m3835423[39m GPU Allocation: [91m1[39m Queue: [91mall.q[39m
User: [91macw778[39m JobID: [91m3833142[39m GPU Allocation: [91m1[39m Queue: [91mall.q[39m
User: [91macw779[39m JobID: [91m3831703[39m GPU Allocation: [91m1[39m Queue: [91mall.q[39m
[91mWarning! GPUs requested but not used![39m
In main
[[36m2024-09-08 09:20:23,246[0m][[34mutils.utils[0m][[32mINFO[0m] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>[0m
[[36m2024-09-08 09:20:23,253[0m][[34mutils.utils[0m][[32mINFO[0m] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>[0m
CONFIG
â”œâ”€â”€ data
â”‚   â””â”€â”€ _target_: src.data.fsd_datamodule.FSDDataModule                         
â”‚       json_path: /data/scratch/acw572/hdf_fsd50k/datafiles/                   
â”‚       data_dir: /data/EECS-MachineListeningLab/datasets/AudioSet              
â”‚       meta_path: /data/EECS-MachineListeningLab/datasets/AudioSet/ground_truth
â”‚       label_csv_pth: /data/scratch/acw572/LHGNN/datafiles/class_labels_indices
â”‚       samplr_csv_pth: /data/scratch/acw572/LHGNN/datafiles/fsd50k_tr_full_weig
â”‚       balance_samplr: true                                                    
â”‚       batch_size: 32                                                          
â”‚       num_workers: 16                                                         
â”‚       pin_memory: true                                                        
â”‚       persistent_workers: true                                                
â”‚       sr: 16000                                                               
â”‚       fmin: 20                                                                
â”‚       fmax: 8000                                                              
â”‚       num_mels: 128                                                           
â”‚       window_type: hanning                                                    
â”‚       target_len: 1024                                                        
â”‚       freqm: 48                                                               
â”‚       timem: 192                                                              
â”‚       mixup: 0.5                                                              
â”‚       norm_mean: -4.6476                                                      
â”‚       norm_std: 4.5699                                                        
â”‚       num_devices: 1                                                          
â”‚                                                                               
â”œâ”€â”€ model
â”‚   â””â”€â”€ _target_: src.models.tagging_module.TaggingModule                       
â”‚       optimizer:                                                              
â”‚         _target_: torch.optim.Adam                                            
â”‚         _partial_: true                                                       
â”‚         lr: 0.001                                                             
â”‚         weight_decay: 5.0e-07                                                 
â”‚         eps: 1.0e-08                                                          
â”‚         betas:                                                                
â”‚         - 0.95                                                                
â”‚         - 0.999                                                               
â”‚       scheduler:                                                              
â”‚         _target_: torch.optim.lr_scheduler.MultiStepLR                        
â”‚         _partial_: true                                                       
â”‚         milestones:                                                           
â”‚         - 10                                                                  
â”‚         - 15                                                                  
â”‚         - 20                                                                  
â”‚         - 25                                                                  
â”‚         - 30                                                                  
â”‚         - 35                                                                  
â”‚         - 40                                                                  
â”‚         gamma: 0.5                                                            
â”‚       net:                                                                    
â”‚         _target_: src.models.components.LHGNN.LHGNN                           
â”‚         k: 25                                                                 
â”‚         act: gelu                                                             
â”‚         norm: batch                                                           
â”‚         bias: true                                                            
â”‚         dropout: 0.0                                                          
â”‚         dilation: true                                                        
â”‚         epsilon: 0.2                                                          
â”‚         drop_path: 0.1                                                        
â”‚         size: s                                                               
â”‚         num_class: 200                                                        
â”‚         emb_dims: 1024                                                        
â”‚         freq_num: 128                                                         
â”‚         time_num: 1024                                                        
â”‚         clusters: 50                                                          
â”‚         cluster_ratio: 0.4                                                    
â”‚         conv: lhg                                                             
â”‚       compile: false                                                          
â”‚       loss: bcelogit                                                          
â”‚       opt_warmup: true                                                        
â”‚       learning_rate: 0.001                                                    
â”‚       lr_rate:                                                                
â”‚       - 0.05                                                                  
â”‚       - 0.02                                                                  
â”‚       - 0.01                                                                  
â”‚       - 0.005                                                                 
â”‚       - 0.002                                                                 
â”‚       - 0.001                                                                 
â”‚       - 0.0005                                                                
â”‚       - 0.0002                                                                
â”‚       lr_scheduler_epoch:                                                     
â”‚       - 10                                                                    
â”‚       - 15                                                                    
â”‚       - 20                                                                    
â”‚       - 25                                                                    
â”‚       - 30                                                                    
â”‚       - 35                                                                    
â”‚       - 50                                                                    
â”‚       - 45                                                                    
â”‚                                                                               
â”œâ”€â”€ callbacks
â”‚   â””â”€â”€ model_checkpoint:                                                       
â”‚         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
â”‚         dirpath: /data/scratch/acw572/LHGNN/logs/train-audioset-new/runs/2024-
â”‚         filename: epoch_{epoch:03d}                                           
â”‚         monitor: val/mAP                                                      
â”‚         verbose: false                                                        
â”‚         save_last: true                                                       
â”‚         save_top_k: 20                                                        
â”‚         mode: max                                                             
â”‚         auto_insert_metric_name: false                                        
â”‚         save_weights_only: false                                              
â”‚         every_n_train_steps: null                                             
â”‚         train_time_interval: null                                             
â”‚         every_n_epochs: null                                                  
â”‚         save_on_train_epoch_end: null                                         
â”‚       early_stopping:                                                         
â”‚         _target_: pytorch_lightning.callbacks.EarlyStopping                   
â”‚         monitor: val/loss                                                     
â”‚         min_delta: 0.0                                                        
â”‚         patience: 5                                                           
â”‚         verbose: false                                                        
â”‚         mode: min                                                             
â”‚         strict: true                                                          
â”‚         check_finite: true                                                    
â”‚         stopping_threshold: null                                              
â”‚         divergence_threshold: null                                            
â”‚         check_on_train_epoch_end: null                                        
â”‚       model_summary:                                                          
â”‚         _target_: pytorch_lightning.callbacks.RichModelSummary                
â”‚         max_depth: -1                                                         
â”‚       tqdm_progress_bar:                                                      
â”‚         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
â”‚                                                                               
â”œâ”€â”€ logger
â”‚   â””â”€â”€ wandb:                                                                  
â”‚         _target_: pytorch_lightning.loggers.WandbLogger                       
â”‚         save_dir: /data/scratch/acw572/LHGNN/logs/train-audioset-new/runs/2024
â”‚         offline: false                                                        
â”‚         id: null                                                              
â”‚         anonymous: null                                                       
â”‚         project: audioset-bal                                                 
â”‚         log_model: false                                                      
â”‚         prefix: ''                                                            
â”‚         group: Tagging                                                        
â”‚         tags:                                                                 
â”‚         - fsd                                                                 
â”‚         - hgcn                                                                
â”‚         job_type: ''                                                          
â”‚                                                                               
â”œâ”€â”€ trainer
â”‚   â””â”€â”€ _target_: pytorch_lightning.trainer.Trainer                             
â”‚       default_root_dir: /data/scratch/acw572/LHGNN/logs/train-audioset-new/run
â”‚       num_sanity_val_steps: 0                                                 
â”‚       min_epochs: 50                                                          
â”‚       max_epochs: 50                                                          
â”‚       accelerator: gpu                                                        
â”‚       devices: 1                                                              
â”‚       gradient_clip_val: 0.5                                                  
â”‚       precision: 16                                                           
â”‚       detect_anomaly: false                                                   
â”‚       check_val_every_n_epoch: 1                                              
â”‚       deterministic: false                                                    
â”‚       strategy: ddp                                                           
â”‚       num_nodes: 1                                                            
â”‚       sync_batchnorm: true                                                    
â”‚       use_distributed_sampler: true                                           
â”‚                                                                               
â”œâ”€â”€ paths
â”‚   â””â”€â”€ root_dir: /data/home/acw572/hgann/HGANN                                 
â”‚       exp_dir: /data/scratch/acw572                                           
â”‚       data_dir: /data/EECS-MachineListeningLab/datasets/AudioSet              
â”‚       meta_dir: /data/EECS-MachineListeningLab/shubhr/hgann                   
â”‚       log_dir: /data/scratch/acw572/LHGNN/logs/                               
â”‚       output_dir: /data/scratch/acw572/LHGNN/logs/train-audioset-new/runs/2024
â”‚       work_dir: /data/home/acw572/hgann/HGANN                                 
â”‚                                                                               
â”œâ”€â”€ extras
â”‚   â””â”€â”€ ignore_warnings: false                                                  
â”‚       enforce_tags: true                                                      
â”‚       print_config: true                                                      
â”‚                                                                               
â”œâ”€â”€ task_name
â”‚   â””â”€â”€ train-audioset-new                                                      
â”œâ”€â”€ pretrained
â”‚   â””â”€â”€ None                                                                    
â”œâ”€â”€ tags
â”‚   â””â”€â”€ ['dev']                                                                 
â”œâ”€â”€ train
â”‚   â””â”€â”€ True                                                                    
â”œâ”€â”€ eval
â”‚   â””â”€â”€ False                                                                   
â”œâ”€â”€ wa
â”‚   â””â”€â”€ False                                                                   
â”œâ”€â”€ pretrain_path
â”‚   â””â”€â”€ /data/scratch/acw572/model_out/train/20240424-063514-pvig_s_224_gelu-224
â”œâ”€â”€ ckpt_path
â”‚   â””â”€â”€ /data/scratch/acw572/LHGNN/logs/train/runs/2024-08-22_21-04-17/checkpoin
â””â”€â”€ seed
    â””â”€â”€ None                                                                    
[[36m2024-09-08 09:20:23,353[0m][[34m__main__[0m][[32mINFO[0m] - [rank: 0] In train[0m
[[36m2024-09-08 09:20:23,353[0m][[34m__main__[0m][[32mINFO[0m] - [rank: 0] Instantiating datamodule <src.data.fsd_datamodule.FSDDataModule>[0m
[[36m2024-09-08 09:20:23,426[0m][[34mutils.utils[0m][[31mERROR[0m] - [rank: 0] [0m
Traceback (most recent call last):
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
          ^^^^^^^^^^^^^^^^^^
AttributeError: module 'src.data' has no attribute 'fsd_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
          ^^^^^^^^^^^^^^^^^^
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/importlib/__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 991, in exec_module
  File "<frozen importlib._bootstrap_external>", line 1129, in get_code
  File "<frozen importlib._bootstrap_external>", line 1059, in source_to_code
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/data/home/acw572/hgann/HGANN/src/data/fsd_datamodule.py", line 195
    sampler=None
            ^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
             ^^^^^^^^^^^^^^^
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.fsd_datamodule.FSDDataModule':
SyntaxError('invalid syntax. Perhaps you forgot a comma?', ('/data/home/acw572/hgann/HGANN/src/data/fsd_datamodule.py', 195, 21, '            sampler=None\n', 196, 26))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/home/acw572/hgann/HGANN/src/utils/utils.py", line 101, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/data/home/acw572/hgann/HGANN/src/train.py", line 75, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.fsd_datamodule.FSDDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[[36m2024-09-08 09:20:23,502[0m][[34mutils.utils[0m][[32mINFO[0m] - [rank: 0] Output dir: /data/scratch/acw572/LHGNN/logs/train-audioset-new/runs/2024-09-08_09-20-23[0m
Error executing job with overrides: ['trainer.max_epochs=50', 'trainer.min_epochs=50', 'trainer.num_nodes=1', 'trainer.devices=1', 'trainer.strategy=ddp', 'data.batch_size=32']
Traceback (most recent call last):
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
          ^^^^^^^^^^^^^^^^^^
AttributeError: module 'src.data' has no attribute 'fsd_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
          ^^^^^^^^^^^^^^^^^^
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/importlib/__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 991, in exec_module
  File "<frozen importlib._bootstrap_external>", line 1129, in get_code
  File "<frozen importlib._bootstrap_external>", line 1059, in source_to_code
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/data/home/acw572/hgann/HGANN/src/data/fsd_datamodule.py", line 195
    sampler=None
            ^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
             ^^^^^^^^^^^^^^^
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.fsd_datamodule.FSDDataModule':
SyntaxError('invalid syntax. Perhaps you forgot a comma?', ('/data/home/acw572/hgann/HGANN/src/data/fsd_datamodule.py', 195, 21, '            sampler=None\n', 196, 26))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/home/acw572/hgann/HGANN/src/train.py", line 199, in <module>
    main()
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
        ^^^^^^^^^^^^^^^^
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/home/acw572/hgann/HGANN/src/train.py", line 183, in main
    metrics,_ = train(cfg)
                ^^^^^^^^^^
  File "/data/home/acw572/hgann/HGANN/src/utils/utils.py", line 111, in wrap
    raise ex
  File "/data/home/acw572/hgann/HGANN/src/utils/utils.py", line 101, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/data/home/acw572/hgann/HGANN/src/train.py", line 75, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/home/acw572/.conda/envs/hgann/lib/python3.12/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.fsd_datamodule.FSDDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
